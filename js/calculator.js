var dataInfo = '{"arena": [{"action": "12", "decision": "11.3", "creativity": "10.3", "name": "\u7231\u60c5\u7684\u5473\u9053", "appetency": "9.6"}, {"action": "9.6", "decision": "12", "creativity": "11.3", "name": "\u60b2\u60e8\u4eba\u751f", "appetency": "10.3"}, {"action": "11.3", "decision": "10.3", "creativity": "9.6", "name": "\u516c\u8def\u5192\u9669", "appetency": "12"}, {"action": "9.6", "decision": "10.3", "creativity": "11.3", "name": "\u60ca\u609a\u8bb0", "appetency": "12"}, {"action": "10.3", "decision": "12", "creativity": "9.6", "name": "\u79d1\u5e7b\u5951\u7ea6", "appetency": "11.3"}, {"action": "10.3", "decision": "11.3", "creativity": "9.6", "name": "\u6050\u6016\u65e5\u8bb0", "appetency": "12"}, {"action": "9.6", "decision": "10.3", "creativity": "12", "name": "\u897f\u90e8\u8fb9\u5883", "appetency": "11.3"}, {"action": "12", "decision": "9.6", "creativity": "10.3", "name": "\u559c\u5267\u5927\u5e08", "appetency": "11.3"}, {"action": "12", "decision": "9.6", "creativity": "11.3", "name": "\u60ac\u5ff5\u65f6\u523b", "appetency": "10.3"}, {"action": "11.3", "decision": "9.6", "creativity": "12", "name": "\u6218\u4e89\u5e74\u4ee3", "appetency": "10.3"}], "instance": [{"action": "0", "decision": "0", "appetency": "0", "creativity": "0", "name": "-"}], "hard": [{"action": "0.65", "decision": "0.35", "creativity": "0.45", "name": "J03-01", "appetency": "0.55"}, {"action": "0.65", "decision": "0.55", "creativity": "0.35", "name": "J03-02", "appetency": "0.45"}, {"action": "0.35", "decision": "0.55", "creativity": "0.65", "name": "J03-03", "appetency": "0.45"}, {"action": "0.55", "decision": "0.45", "creativity": "0.35", "name": "J03-04", "appetency": "0.65"}, {"action": "0.65", "decision": "0.55", "creativity": "0.45", "name": "J03-05", "appetency": "0.35"}, {"action": "0.45", "decision": "0.65", "creativity": "0.55", "name": "J03-06", "appetency": "0.35"}, {"action": "0.35", "decision": "0.65", "creativity": "0.55", "name": "J03-07", "appetency": "0.45"}, {"action": "0.45", "decision": "0.35", "creativity": "0.55", "name": "J03-08", "appetency": "0.65"}, {"action": "0.55", "decision": "0.45", "creativity": "0.65", "name": "J03-09", "appetency": "0.35"}, {"action": "0.55", "decision": "0.45", "creativity": "0.35", "name": "J03-10", "appetency": "0.65"}, {"action": "0.65", "decision": "0.45", "creativity": "0.35", "name": "J04-01", "appetency": "0.55"}, {"action": "0.45", "decision": "0.65", "creativity": "0.55", "name": "J04-02", "appetency": "0.35"}, {"action": "0.55", "decision": "0.65", "creativity": "0.35", "name": "J04-03", "appetency": "0.45"}, {"action": "0.65", "decision": "0.35", "creativity": "0.55", "name": "J04-04", "appetency": "0.45"}, {"action": "0.65", "decision": "0.45", "creativity": "0.55", "name": "J04-05", "appetency": "0.35"}, {"action": "0.35", "decision": "0.55", "creativity": "0.65", "name": "J04-06", "appetency": "0.45"}, {"action": "0.45", "decision": "0.35", "creativity": "0.65", "name": "J04-07", "appetency": "0.55"}, {"action": "0.45", "decision": "0.65", "creativity": "0.35", "name": "J04-08", "appetency": "0.55"}, {"action": "0.45", "decision": "0.55", "creativity": "0.66", "name": "J04-09", "appetency": "0.35"}, {"action": "0.45", "decision": "0.55", "creativity": "0.36", "name": "J04-10", "appetency": "0.65"}, {"action": "0.4", "decision": "0.6", "creativity": "0.75", "name": "J05-01", "appetency": "0.25"}, {"action": "0.6", "decision": "0.75", "creativity": "0.4", "name": "J05-02", "appetency": "0.25"}, {"action": "0.4", "decision": "0.75", "creativity": "0.25", "name": "J05-03", "appetency": "0.6"}, {"action": "0.4", "decision": "0.25", "creativity": "0.75", "name": "J05-04", "appetency": "0.6"}, {"action": "0.4", "decision": "0.6", "creativity": "0.25", "name": "J05-05", "appetency": "0.75"}, {"action": "0.75", "decision": "0.25", "creativity": "0.40", "name": "J05-06", "appetency": "0.60"}, {"action": "0.4", "decision": "0.25", "creativity": "0.75", "name": "J05-07", "appetency": "0.6"}, {"action": "0.25", "decision": "0.4", "creativity": "0.6", "name": "J05-08", "appetency": "0.75"}, {"action": "0.25", "decision": "0.4", "creativity": "0.6", "name": "J05-09", "appetency": "0.75"}, {"action": "0.75", "decision": "0.6", "creativity": "0.4", "name": "J05-10", "appetency": "0.25"}, {"action": "0.6", "decision": "0.25", "creativity": "0.4", "name": "J06-01", "appetency": "0.75"}, {"action": "0.4", "decision": "0.6", "creativity": "0.25", "name": "J06-02", "appetency": "0.75"}, {"action": "0.6", "decision": "0.25", "creativity": "0.4", "name": "J06-03", "appetency": "0.75"}, {"action": "0.4", "decision": "0.6", "creativity": "0.25", "name": "J06-04", "appetency": "0.75"}, {"action": "0.4", "decision": "0.25", "creativity": "0.75", "name": "J06-05", "appetency": "0.6"}, {"action": "0.75", "decision": "0.25", "creativity": "0.6", "name": "J06-06", "appetency": "0.4"}, {"action": "0.25", "decision": "0.75", "creativity": "0.4", "name": "J06-07", "appetency": "0.6"}, {"action": "0.4", "decision": "0.75", "creativity": "0.25", "name": "J06-08", "appetency": "0.6"}, {"action": "0.4", "decision": "0.75", "creativity": "0.6", "name": "J06-09", "appetency": "0.25"}, {"action": "0.6", "decision": "0.4", "creativity": "0.25", "name": "J06-10", "appetency": "0.75"}, {"action": "0.85", "decision": "0.35", "creativity": "0.6", "name": "J07-01", "appetency": "0.2"}, {"action": "0.85", "decision": "0.2", "creativity": "0.35", "name": "J07-02", "appetency": "0.6"}, {"action": "0.2", "decision": "0.35", "creativity": "0.85", "name": "J07-03", "appetency": "0.6"}, {"action": "0.2", "decision": "0.6", "creativity": "0.85", "name": "J07-04", "appetency": "0.35"}, {"action": "0.85", "decision": "0.6", "creativity": "0.35", "name": "J07-05", "appetency": "0.2"}, {"action": "0.35", "decision": "0.85", "creativity": "0.2", "name": "J07-06", "appetency": "0.6"}, {"action": "0.35", "decision": "0.85", "creativity": "0.2", "name": "J07-07", "appetency": "0.6"}, {"action": "0.2", "decision": "0.85", "creativity": "0.6", "name": "J07-08", "appetency": "0.35"}, {"action": "0.6", "decision": "0.85", "creativity": "0.35", "name": "J07-09", "appetency": "0.2"}, {"action": "0.6", "decision": "0.35", "creativity": "0.85", "name": "J07-10", "appetency": "0.2"}, {"action": "0.35", "decision": "0.85", "creativity": "0.2", "name": "J08-01", "appetency": "0.6"}, {"action": "0.6", "decision": "0.2", "creativity": "0.35", "name": "J08-02", "appetency": "0.85"}, {"action": "0.85", "decision": "0.2", "creativity": "0.6", "name": "J08-03", "appetency": "0.35"}, {"action": "0.85", "decision": "0.60", "creativity": "0.35", "name": "J08-04", "appetency": "0.20"}, {"action": "0.6", "decision": "0.35", "creativity": "0.85", "name": "J08-05", "appetency": "0.2"}, {"action": "0.85", "decision": "0.35", "creativity": "0.6", "name": "J08-06", "appetency": "0.2"}, {"action": "0.85", "decision": "0.2", "creativity": "0.35", "name": "J08-07", "appetency": "0.6"}, {"action": "0.85", "decision": "0.35", "creativity": "0.2", "name": "J08-08", "appetency": "0.6"}, {"action": "0.2", "decision": "0.85", "creativity": "0.35", "name": "J08-09", "appetency": "0.6"}, {"action": "0.6", "decision": "0.85", "creativity": "0.35", "name": "J08-10", "appetency": "0.2"}, {"action": "0.2", "decision": "0.6", "creativity": "0.3", "name": "J09-01", "appetency": "0.9"}, {"action": "0.2", "decision": "0.3", "creativity": "0.6", "name": "J09-02", "appetency": "0.9"}, {"action": "0.6", "decision": "0.9", "creativity": "0.3", "name": "J09-03", "appetency": "0.2"}, {"action": "0.2", "decision": "0.9", "creativity": "0.6", "name": "J09-04", "appetency": "0.3"}, {"action": "0.9", "decision": "0.6", "creativity": "0.3", "name": "J09-05", "appetency": "0.2"}, {"action": "0.3", "decision": "0.6", "creativity": "0.9", "name": "J09-06", "appetency": "0.2"}, {"action": "0.9", "decision": "0.3", "creativity": "0.2", "name": "J09-07", "appetency": "0.6"}, {"action": "0.9", "decision": "0.2", "creativity": "0.6", "name": "J09-08", "appetency": "0.3"}, {"action": "0.9", "decision": "0.6", "creativity": "0.3", "name": "J09-09", "appetency": "0.2"}, {"action": "0.9", "decision": "0.6", "creativity": "0.3", "name": "J09-10", "appetency": "0.2"}, {"action": "0.6", "decision": "0.2", "creativity": "0.3", "name": "J10-01", "appetency": "0.9"}, {"action": "0.3", "decision": "0.6", "creativity": "0.9", "name": "J10-02", "appetency": "0.2"}, {"action": "0.9", "decision": "0.6", "creativity": "0.3", "name": "J10-03", "appetency": "0.2"}, {"action": "0.9", "decision": "0.2", "creativity": "0.3", "name": "J10-04", "appetency": "0.6"}, {"action": "0.6", "decision": "0.2", "creativity": "0.3", "name": "J10-05", "appetency": "0.9"}, {"action": "0.2", "decision": "0.6", "creativity": "0.3", "name": "J10-06", "appetency": "0.9"}, {"action": "0.6", "decision": "0.2", "creativity": "0.9", "name": "J10-07", "appetency": "0.3"}, {"action": "0.3", "decision": "0.2", "creativity": "0.6", "name": "J10-08", "appetency": "0.9"}, {"action": "0.2", "decision": "0.9", "creativity": "0.3", "name": "J10-09", "appetency": "0.6"}, {"action": "0.2", "decision": "0.6", "creativity": "0.3", "name": "J10-10", "appetency": "0.9"}], "normal": [{"action": "0.53", "decision": "0.55", "creativity": "0.47", "name": "02-01", "appetency": "0.45"}, {"action": "0.53", "decision": "0.45", "creativity": "0.55", "name": "02-04", "appetency": "0.47"}, {"action": "0.45", "decision": "0.55", "creativity": "0.47", "name": "02-05", "appetency": "0.53"}, {"action": "0.45", "decision": "0.55", "creativity": "0.53", "name": "02-07", "appetency": "0.47"}, {"action": "0.55", "decision": "0.53", "creativity": "0.47", "name": "02-08", "appetency": "0.45"}, {"action": "0.47", "decision": "0.53", "creativity": "0.45", "name": "02-09", "appetency": "0.55"}, {"action": "0.45", "decision": "0.47", "creativity": "0.53", "name": "02-13", "appetency": "0.55"}, {"action": "0.47", "decision": "0.45", "creativity": "0.53", "name": "02-14", "appetency": "0.55"}, {"action": "0.53", "decision": "0.45", "creativity": "0.55", "name": "02-17", "appetency": "0.47"}, {"action": "0.53", "decision": "0.45", "creativity": "0.55", "name": "02-18", "appetency": "0.47"}, {"action": "0.35", "decision": "0.55", "creativity": "0.65", "name": "03-02", "appetency": "0.45"}, {"action": "0.55", "decision": "0.35", "creativity": "0.45", "name": "03-05", "appetency": "0.65"}, {"action": "0.55", "decision": "0.65", "creativity": "0.35", "name": "03-06", "appetency": "0.45"}, {"action": "0.55", "decision": "0.65", "creativity": "0.45", "name": "03-09", "appetency": "0.35"}, {"action": "0.65", "decision": "0.45", "creativity": "0.35", "name": "03-11", "appetency": "0.55"}, {"action": "0.45", "decision": "0.55", "creativity": "0.65", "name": "03-13", "appetency": "0.35"}, {"action": "0.55", "decision": "0.65", "creativity": "0.35", "name": "03-14", "appetency": "0.45"}, {"action": "0.65", "decision": "0.55", "creativity": "0.35", "name": "03-16", "appetency": "0.45"}, {"action": "0.55", "decision": "0.45", "creativity": "0.65", "name": "03-18", "appetency": "0.35"}, {"action": "0.55", "decision": "0.35", "creativity": "0.65", "name": "03-19", "appetency": "0.45"}, {"action": "0.45", "decision": "0.65", "creativity": "0.55", "name": "04-03", "appetency": "0.35"}, {"action": "0.55", "decision": "0.65", "creativity": "0.45", "name": "04-04", "appetency": "0.35"}, {"action": "0.45", "decision": "0.55", "creativity": "0.65", "name": "04-07", "appetency": "0.35"}, {"action": "0.65", "decision": "0.55", "creativity": "0.35", "name": "04-08", "appetency": "0.45"}, {"action": "0.55", "decision": "0.45", "creativity": "0.65", "name": "04-10", "appetency": "0.35"}, {"action": "0.65", "decision": "0.45", "creativity": "0.35", "name": "04-12", "appetency": "0.55"}, {"action": "0.35", "decision": "0.45", "creativity": "0.55", "name": "04-14", "appetency": "0.65"}, {"action": "0.45", "decision": "0.65", "creativity": "0.35", "name": "04-15", "appetency": "0.55"}, {"action": "0.45", "decision": "0.55", "creativity": "0.35", "name": "04-17", "appetency": "0.65"}, {"action": "0.55", "decision": "0.45", "creativity": "0.35", "name": "04-19", "appetency": "0.65"}, {"action": "0.45", "decision": "0.55", "creativity": "0.35", "name": "05-02", "appetency": "0.65"}, {"action": "0.65", "decision": "0.55", "creativity": "0.45", "name": "05-03", "appetency": "0.35"}, {"action": "0.55", "decision": "0.45", "creativity": "0.65", "name": "05-05", "appetency": "0.35"}, {"action": "0.55", "decision": "0.35", "creativity": "0.45", "name": "05-08", "appetency": "0.65"}, {"action": "0.65", "decision": "0.45", "creativity": "0.55", "name": "05-09", "appetency": "0.35"}, {"action": "0.75", "decision": "0.25", "creativity": "0.4", "name": "05-11", "appetency": "0.6"}, {"action": "0.75", "decision": "0.6", "creativity": "0.25", "name": "05-13", "appetency": "0.4"}, {"action": "0.25", "decision": "0.6", "creativity": "0.4", "name": "05-15", "appetency": "0.75"}, {"action": "0.4", "decision": "0.6", "creativity": "0.25", "name": "05-18", "appetency": "0.75"}, {"action": "0.75", "decision": "0.4", "creativity": "0.25", "name": "05-20", "appetency": "0.6"}, {"action": "0.6", "decision": "0.25", "creativity": "0.4", "name": "06-03", "appetency": "0.75"}, {"action": "0.75", "decision": "0.4", "creativity": "0.6", "name": "06-04", "appetency": "0.25"}, {"action": "0.6", "decision": "0.25", "creativity": "0.4", "name": "06-06", "appetency": "0.75"}, {"action": "0.6", "decision": "0.75", "creativity": "0.25", "name": "06-07", "appetency": "0.4"}, {"action": "0.75", "decision": "0.25", "creativity": "0.6", "name": "06-09", "appetency": "0.4"}, {"action": "0.6", "decision": "0.25", "creativity": "0.4", "name": "06-10", "appetency": "0.75"}, {"action": "0.4", "decision": "0.75", "creativity": "0.6", "name": "06-12", "appetency": "0.25"}, {"action": "0.75", "decision": "0.25", "creativity": "0.6", "name": "06-14", "appetency": "0.4"}, {"action": "0.25", "decision": "0.4", "creativity": "0.6", "name": "06-15", "appetency": "0.75"}, {"action": "0.25", "decision": "0.6", "creativity": "0.75", "name": "06-17", "appetency": "0.4"}, {"action": "0.6", "decision": "0.35", "creativity": "0.85", "name": "06-18", "appetency": "0.2"}, {"action": "0.35", "decision": "0.85", "creativity": "0.2", "name": "07-03", "appetency": "0.6"}, {"action": "0.6", "decision": "0.85", "creativity": "0.2", "name": "07-05", "appetency": "0.35"}, {"action": "0.35", "decision": "0.85", "creativity": "0.6", "name": "07-07", "appetency": "0.2"}, {"action": "0.6", "decision": "0.85", "creativity": "0.35", "name": "07-10", "appetency": "0.2"}, {"action": "0.85", "decision": "0.35", "creativity": "0.6", "name": "07-13", "appetency": "0.2"}, {"action": "0.35", "decision": "0.6", "creativity": "0.2", "name": "07-15", "appetency": "0.85"}, {"action": "0.85", "decision": "0.2", "creativity": "0.6", "name": "07-17", "appetency": "0.35"}, {"action": "0.6", "decision": "0.35", "creativity": "0.2", "name": "07-19", "appetency": "0.85"}, {"action": "0.2", "decision": "0.6", "creativity": "0.35", "name": "07-21", "appetency": "0.85"}, {"action": "0.2", "decision": "0.85", "creativity": "0.6", "name": "07-22", "appetency": "0.35"}, {"action": "0.35", "decision": "0.85", "creativity": "0.2", "name": "08-02", "appetency": "0.6"}, {"action": "0.85", "decision": "0.2", "creativity": "0.35", "name": "08-05", "appetency": "0.6"}, {"action": "0.85", "decision": "0.35", "creativity": "0.2", "name": "08-08", "appetency": "0.6"}, {"action": "0.35", "decision": "0.2", "creativity": "0.6", "name": "08-09", "appetency": "0.85"}, {"action": "0.35", "decision": "0.2", "creativity": "0.85", "name": "08-11", "appetency": "0.6"}, {"action": "0.2", "decision": "0.85", "creativity": "0.6", "name": "08-15", "appetency": "0.35"}, {"action": "0.85", "decision": "0.2", "creativity": "0.35", "name": "08-16", "appetency": "0.6"}, {"action": "0.6", "decision": "0.85", "creativity": "0.2", "name": "08-18", "appetency": "0.35"}, {"action": "0.35", "decision": "0.85", "creativity": "0.6", "name": "08-20", "appetency": "0.2"}, {"action": "0.6", "decision": "0.85", "creativity": "0.2", "name": "08-22", "appetency": "0.35"}, {"action": "0.35", "decision": "0.6", "creativity": "0.2", "name": "09-03", "appetency": "0.85"}, {"action": "0.85", "decision": "0.35", "creativity": "0.6", "name": "09-04", "appetency": "0.2"}, {"action": "0.35", "decision": "0.2", "creativity": "0.6", "name": "09-06", "appetency": "0.85"}, {"action": "0.6", "decision": "0.85", "creativity": "0.35", "name": "09-09", "appetency": "0.2"}, {"action": "0.35", "decision": "0.85", "creativity": "0.6", "name": "09-12", "appetency": "0.2"}, {"action": "0.35", "decision": "0.2", "creativity": "0.6", "name": "09-13", "appetency": "0.85"}, {"action": "0.35", "decision": "0.6", "creativity": "0.2", "name": "09-16", "appetency": "0.85"}, {"action": "0.35", "decision": "0.6", "creativity": "0.85", "name": "09-17", "appetency": "0.2"}, {"action": "0.35", "decision": "0.6", "creativity": "0.85", "name": "09-19", "appetency": "0.2"}, {"action": "0.85", "decision": "0.35", "creativity": "0.2", "name": "09-21", "appetency": "0.6"}, {"action": "0.85", "decision": "0.6", "creativity": "0.2", "name": "10-03", "appetency": "0.35"}, {"action": "0.2", "decision": "0.6", "creativity": "0.35", "name": "10-06", "appetency": "0.85"}, {"action": "0.6", "decision": "0.85", "creativity": "0.2", "name": "10-09", "appetency": "0.35"}, {"action": "0.6", "decision": "0.35", "creativity": "0.2", "name": "10-12", "appetency": "0.85"}, {"action": "0.2", "decision": "0.6", "creativity": "0.35", "name": "10-13", "appetency": "0.85"}, {"action": "0.85", "decision": "0.2", "creativity": "0.6", "name": "10-16", "appetency": "0.35"}, {"action": "0.2", "decision": "0.85", "creativity": "0.6", "name": "10-19", "appetency": "0.35"}, {"action": "0.6", "decision": "0.2", "creativity": "0.35", "name": "10-22", "appetency": "0.85"}, {"action": "0.2", "decision": "0.35", "creativity": "0.6", "name": "10-23", "appetency": "0.85"}, {"action": "0.85", "decision": "0.35", "creativity": "0.2", "name": "10-24", "appetency": "0.6"}]}';
var weights = eval('(' + dataInfo + ')');
var w_decision = 0, w_creativity = 0, w_appetency = 0, w_action = 0;
var cards;
var max_cards = -1;

function loadName(category) {
    $('#stage-name').empty();
    var str = "";
    for (var i in weights[category]) {
        str += "<option value =\""+weights[category][i]["name"]+"\">"+weights[category][i]["name"]+"</option>";
    }
    $('#stage-name').append(str);
}

function loadWeight(category, name) {
    for (var i in weights[category]) {
        if (weights[category][i]["name"] == name) {
            w_decision = parseFloat(weights[category][i]["decision"]);
            w_creativity = parseFloat(weights[category][i]["creativity"]);
            w_appetency = parseFloat(weights[category][i]["appetency"]);
            w_action = parseFloat(weights[category][i]["action"]);
            $('#stage-decision').text(weights[category][i]["decision"]);
            $('#stage-creativity').text(weights[category][i]["creativity"]);
            $('#stage-appetency').text(weights[category][i]["appetency"]);
            $('#stage-action').text(weights[category][i]["action"]);
            break;
        }
    }
    calScore();
}

function setCookie(c_name, value, expiredays)
{
    var exdate = new Date();
    exdate.setDate(exdate.getDate() + expiredays);
    document.cookie = c_name+ "=" + escape(value) + ((expiredays==null) ? "" : ";expires=" + exdate.toGMTString());
}

function getCookie(c_name)
{
  if (document.cookie.length > 0)
  {
      var c_start = document.cookie.indexOf(c_name + "=");
      if (c_start != -1)
      { 
        c_start = c_start + c_name.length + 1;
        var c_end = document.cookie.indexOf(";", c_start);
        if (c_end == -1) 
            c_end = document.cookie.length;
        return unescape(document.cookie.substring(c_start,c_end));
      } 
  }
  return ""
}

function checkCookie() {
    var cardData = getCookie('cardData');
    if (cardData != null && cardData != "") {
        cards = eval('(' + cardData + ')');
        showCards();
    }
    else {
        cards = new Object();
        cards["list"] = new Array();
    }
}

function importCard() {
    var data = $('#import-text').val();
    try {
        cards = JSON.parse(data);
        alert("导入成功!");
        $('#import-text').val('');
        setCookie('cardData', data, 100);
        showCards();
    }
    catch(err) {
        alert("请输入符合JSON格式的数据!");
    }
}

function exportCard() {
    var str = JSON.stringify(cards);
    $('#import-text').empty();
    $('#import-text').append(str);
}

function showCards() {
    $('#card-table').empty();
    var str = "";
    var card_list = cards["list"];
    for (var i in card_list) {
        str += "<tr id=\""+card_list[i]["id"]+"\"><td>"+card_list[i]["name"]+"</td><td>"+card_list[i]["decision"]+"</td><td>"+card_list[i]["creativity"]+"</td><td>"+card_list[i]["appetency"]+"</td><td>"+card_list[i]["action"]+"</td><td><a href=\"javascript:void(0);\" onclick=\"deleteCard('"+card_list[i]["id"]+"')\">删除</a></td></tr>";
    }
    $('#card-table').append(str);
    calScore();
}

function deleteCard(id) {
    for (var i in cards["list"]) {
        if (cards["list"][i]["id"] == id) {
            cards["list"].splice(i, 1);
            alert("删除成功!");
            break;
        }
    }
    setCookie('cardData', JSON.stringify(cards), 100);
    showCards();
}

function addCard() {
    var name = $('#card-name').val();
    var decision = parseInt('0'+$('#card-decision').val());
    var creativity = parseInt('0'+$('#card-creativity').val());
    var appetency = parseInt('0'+$('#card-appetency').val());
    var action = parseInt('0'+$('#card-action').val());
    var evol_card = new Object();
    if (name == "" || name == null) {
        alert("请输入完整的羁绊信息!");
        return;
    }
    evol_card["name"] = name;
    evol_card["decision"] = decision;
    evol_card["creativity"] = creativity;
    evol_card["appetency"] = appetency;
    evol_card["action"] = action;
    evol_card["id"] = (new Date()).valueOf();
    alert("羁绊: "+name+" 添加成功!");
    cards["list"].push(evol_card);
    setCookie('cardData', JSON.stringify(cards), 100);
    showCards();
    $('#card-name').val('');
    $('#card-decision').val('');
    $('#card-creativity').val('');
    $('#card-appetency').val('');
    $('#card-action').val('');
}

function sortNumber(a, b) {
    return b["score"] - a["score"];
}

function calScore() {
    $('#recommendation').empty();
    var str = "";
    var card_list = new Array();
    for (var i in cards["list"]) {
        card_list[i] = cards["list"][i];
        card_list[i]["score"] = Math.round(w_decision*card_list[i]["decision"]+w_creativity*card_list[i]["creativity"]+w_appetency*card_list[i]["appetency"]+w_action*card_list[i]["action"]);
    }
    card_list.sort(sortNumber);
    for (var i in card_list) {
        if (max_cards == -1 || i < max_cards) {
            str += "<tr id=\""+card_list[i]["id"]+"\"><td>"+card_list[i]["name"]+"</td><td>"+card_list[i]["decision"]+"</td><td>"+card_list[i]["creativity"]+"</td><td>"+card_list[i]["appetency"]+"</td><td>"+card_list[i]["action"]+"</td><td><b>"+card_list[i]["score"]+"</b></td></tr>";
        }
    }
    $('#recommendation').append(str);
}

function setMaxNum(num) {
    max_cards = parseInt(num);
    calScore();
}

